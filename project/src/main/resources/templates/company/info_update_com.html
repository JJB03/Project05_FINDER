<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{/layout/company_layout}">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>

        /* ì´ ì¹œêµ¬ë“¤ì´ ë²„íŠ¼ ë³€ê²½í•˜ê²Œ í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.*/
           .btn-male, .btn-female {
           padding: 10px 10px;
           margin: 5px;
           color: black;
           background-color: #EDEDED;
           cursor: pointer;
       }

       .btn-male.selected, .btn-female.selected {
           background-color: #007bff;
           color: white;
       }
   </style>
    <title>ê¸°ì—… ì •ë³´ ìˆ˜ì •</title>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
</head>

<body layout:fragment="content">

    <div class="container-fluid container">
        <div style="display: flex; flex-direction: column; margin-left: 100px; margin-bottom: 50px;">
            <strong style="font-size: 45px; margin-bottom: 15px;">ê¸°ì—… ì •ë³´</strong>
            <strong style="font-size: 19px;">ëª¨ë‘ê°€ ì£¼ì¸ì´ ë˜ëŠ” ë¬¸í™”ë¥¼ í†µí•´, ê¿ˆì„ í˜„ì‹¤ë¡œ ë§Œë“­ë‹ˆë‹¤.</strong>
        </div>

        <div class="row justify-content-center" style="padding: 0 40px 0 40px;">

            <nav class="col-12 col-sm-12 col-lg-3 sidebar">
                <div style="margin: 15px 0 45px 15px;">
                    <strong style="font-size: 24px;">
                        ë§ˆì´í˜ì´ì§€
                    </strong>
                </div>
                <ul class="nav flex-column ul-header">
                    <li class="li-header">
                        <strong class="fs-5">ê¸°ì—… ì •ë³´</strong>
                    </li>
                    <li class="nav-item">
                        <a href="/company/introduce_com" class="job-item-link nav-link fw-normal fs-6">
                            <div style="background-color: #fff; border-radius: 8px;" class="d-flex gap-2 p-2 ps-2">
                                <div>
                                    <img src="/img/home.png" alt="x">
                                </div>
                                <div>
                                    ê¸°ì—… ì†Œê°œ
                                </div>
                            </div>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/company/info_update_com" class="job-item-link nav-link fw-normal fs-6">
                            <div style="background-color: #fff; border-radius: 8px;" class="d-flex gap-2 p-2 ps-2">
                                <div>
                                    <img src="/img/Registration.png" alt="x">
                                </div>
                                <div>
                                    ê¸°ì—… ì •ë³´ ìˆ˜ì •
                                </div>
                            </div>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/company/credit_list_com" class="job-item-link nav-link fw-normal fs-6">
                            <div style="background-color: #fff; border-radius: 8px;" class="d-flex gap-2 p-2 ps-2">
                                <div>
                                    <img src="/img/CreditCard.png" alt="x">
                                </div>
                                <div>
                                    ê²°ì œ ë‚´ì—­
                                </div>
                            </div>
                        </a>
                    </li>
                </ul>
                <ul class="nav flex-column ul-header">
                    <li class="li-header">
                        <strong class="fs-5">ì±„ìš©ê³µê³  ê´€ë¦¬</strong>
                    </li>
                    <li class="nav-item">
                        <a href="/recruit/post_jobs_com" class="job-item-link nav-link fw-normal fs-6">
                            <div style="background-color: #fff; border-radius: 8px; " class="d-flex gap-2 p-2 ps-2">
                                <div>
                                    <img src="/img/list.png" alt="x">
                                </div>
                                <div>
                                    ì±„ìš©ê³µê³  ë“±ë¡
                                </div>
                            </div>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/recruit/posted_jobs_com" class="job-item-link nav-link fw-normal fs-6">
                            <div style="background-color: #fff; border-radius: 8px; " class="d-flex gap-2 p-2 ps-2">
                                <div>
                                    <img src="/img/list.png" alt="x">
                                </div>
                                <div>
                                    ë“±ë¡í•œ ì±„ìš©ê³µê³ 
                                </div>
                            </div>
                        </a>
                    </li>
                </ul>
                <ul class="nav flex-column ul-header">
                    <li class="li-header">
                        <strong class="fs-5">ì´ë ¥ì„œ ê´€ë¦¬</strong>
                    </li>
                    <li class="nav-item">
                        <a href="/company/recruit_list_com" class="job-item-link nav-link fw-normal fs-6">
                            <div style="background-color: #fff; border-radius: 8px; " class="d-flex gap-2 p-2 ps-2">
                                <div>
                                    <img src="/img/Documents.png" alt="x">
                                </div>
                                <div>
                                    ì œì¶œëœ ì´ë ¥ì„œ
                                </div>
                            </div>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/company/score_com" class="job-item-link nav-link fw-normal fs-6">
                            <div style="background-color: #fff; border-radius: 8px; " class="d-flex gap-2 p-2 ps-2">
                                <div>
                                    <img src="/img/Documents.png" alt="x">
                                </div>
                                <div>
                                    AI ê°„í¸ í‰ê°€
                                </div>
                            </div>
                        </a>
                    </li>
                </ul>
            </nav>


         <main class="col-12 col-md-12 col-lg-8 main-content d-flex justify-content-end align-items-start">
                <div class="job-listings d-flex flex-column align-items-center">
                    <div class="job-header w-100">
                        <div style="padding: 15px;"><strong>ê¸°ì—… ì •ë³´ ìˆ˜ì •</strong></div>
                    </div>

                    <!-- ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í¼ -->
                    <form action="/company/update_com_pw" method="post" class="register-form" style="width:100% !important; border-radius: 12px; background-color: #FAFAFA;">
                        <!-- CSRF í† í° -->
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                        <div for="username" class="userid">ì•„ì´ë””</div>
                        <div id="id">
                                <!-- ì‚¬ìš©ì ì•„ì´ë”” -->
                                <input type="text" id="username" th:value="${session.user.userId}" name="username" placeholder="ì‚¬ìš©ì ì•„ì´ë””"
                                    readonly>
                                </div>
                                <br>
                                <div class="d-flex flex-column">
                                    <div for="password" class="userpw" style="width: 84px; text-align: center;">ë¹„ë°€ë²ˆí˜¸</div>
                                    
                                    <!-- í˜„ì¬ DBì— ë“¤ì–´ìˆëŠ” ë¹„ë°€ë²ˆí˜¸ -->
                                    <input type="password" id="userBeforePw" name="userBeforePw" placeholder="í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" required>
                                    <button onclick="PW_Confirm()" class="btn-in-short align-self-end" style="margin-right: 10px; background-color: var(--long-btn-color);">í™•ì¸</button>
                                    
                                    <input type="password" id="userPw" name="userPw" placeholder="8~16ìë¦¬/ì˜ë¬¸ ëŒ€ì†Œë¬¸ì,ìˆ«ì,íŠ¹ìˆ˜ë¬¸ì ì¡°í•©" required>
                                    <input type="password" id="confirm-password" name="confirm-password" required placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸">
                                    
                            <!-- í¼ ì „ì†¡ë²„íŠ¼ -->
                            <button onclick="validatePasswordConfirmation()" id="UpdatePw" type="submit" class="btn-in-short align-self-end" style="margin-right: 10px; background-color: var(--long-btn-color);">ë³€ê²½</button> <br>
                        </div> 

                    </form>



                    <!-- ì´ë¦„/ìƒë…„ì›”ì¼/íœ´ëŒ€í°/ì´ë©”ì¼/ê¸°ì—…ì£¼ì†Œ ë³€ê²½ í¼ -->
                    <form action="/company/update_com_info" method="post" class="register-form mt-4" style="border-radius: 12px; background-color: #FAFAFA;">
                        <!-- CSRF í† í° -->
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                        <input type="hidden" th:name="userNo" th:value="${session.user.userNo}">
                        <div for="name" class="username" style="width: 55px; text-align: center;">ì´ë¦„</div>
                        
                        <div class="gender">
                            <!-- ì´ë¦„ -->
                            <input class="input-name" type="text" id="name" name="userName" th:value="${session.user.userName}" required placeholder="ì´ë¦„" readonly>
                            <div class="gender-btn">
                                <button type="button" class="btn-male" id="male" name="gender">ë‚¨</button>
                                <button type="button" class="btn-female" id="female" name="gender">ì—¬</button>
                            </div> 
                        </div>
        
                        <div for="birthdate" class="userbirth" style="width: 84px; text-align: center;">ìƒë…„ì›”ì¼</div>

                        <div class="birthdate">
                            <input type="date" id="startDate" th:value="${session.user.userBirth}" name="userBirth" class="keyword-main">
                        </div>


                        <div for="phone" class="userphone">íœ´ëŒ€í°</div>
                        <div class="phone d-flex flex-column">
                            <!-- íœ´ëŒ€í°ë²ˆí˜¸ -->
                            <input type="text" id="phone" name="userPhone" th:value="${session.user.userPhone}" required >                            
                        </div>
        
                        <div for="email" class="useremail">
                            ì´ë©”ì¼
                        </div>
                        <div class="phone d-flex flex-column">
                            <!-- ì´ë©”ì¼ -->
                            <input type="email" id="email" name="userEmail" th:value="${session.user.userEmail}" required >
                        </div>

                        <div for="address" class="useraddress">
                            ê¸°ì—… ì£¼ì†Œ
                        </div>
                        <div class="phone d-flex flex-column">
                            <!-- ê¸°ì—…ì£¼ì†Œ -->
                            <input type="text" id="address" name="comAddress" th:value="${session.user.company.comAddress}" required >

                            <!-- í¼ ì „ì†¡ë²„íŠ¼ -->
                            <button type="submit" class="btn-in-short align-self-end" style="margin-right: 10px; background-color: var(--long-btn-color);">ë³€ê²½</button>
                        </div>
                    </form>

                    

                </div>
            </main>
        </div>

    </div>

    <script>
        
        // ì„±ë³„ í‘œì‹œ
        $(function() { // í˜ì´ì§€ê°€ ë¡œë“œë˜ê¸° ì „ì— ì‹¤í–‰ì‹œí‚¬ ì½”ë“œë“¤
            var gender = "[[${session.user.userGender}]]";

            if(gender=="ë‚¨ì"){
                $('#male').css('backgroundColor', 'var(--sub-color)')
                $('#male').css('color', 'white')
            }else{
                $('#female').css('backgroundColor', 'var(--sub-color)')
                $('#female').css('color', 'white')
            }

        });



        function PW_Confirm() {
            // ğŸ’ CRSF TOKEN
            var csrfToken = "[[${_csrf.token}]]"
            let url = "/company/update_com_pw" 
            var userBeforePw = document.getElementById('userBeforePw').value;
            // var userNo = "[[${session.user.userNo}]]";

            // jQuery ë¡œ AJAX ìš”ì²­
            $.ajax({
                type            : 'POST',             // ìš”ì²­ ë©”ì†Œë“œ - GET, POST, PUT, DELETE
                url             : url,                    // ìš”ì²­ URL
                data            : {
                                    password : userBeforePw
                                  },
                // ìš”ì²­ ë°ì´í„°
                contentType     : 'application/json',     // ìš”ì²­ ë°ì´í„° íƒ€ì…
                dataType        : 'json',                 // ì‘ë‹µ ë°ì´í„° íƒ€ì…
                beforeSend: function(xhr) {
                    // ğŸ’ CSRF í† í°ì„ ìš”ì²­ í—¤ë”ì— ì¶”ê°€
                    xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                },
                // ìš”ì²­ ì„±ê³µ 
                success         : function(response, status) {
                    // response : ì‘ë‹µ ë°ì´í„°
                    // status   : ì‘ë‹µ ìƒíƒœ
                    if(response) {
                        alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.');
                    } else {
                        alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.')
                    }
                },
                // ì—ëŸ¬
                error           : function(xhr, status) {
                    // xhr      : XMLHttpRequest ê°ì²´
                    // status   : ì‘ë‹µ ìƒíƒœ
                    alert('ì—ëŸ¬ ë°œìƒ')
                }
            });
        }



        // ë¹„ë°€ë²ˆí˜¸ í™•ì¸
        // function validatePasswordConfirmation() {
        //     var password = document.getElementsByName("userPw")[0].value;
        //     var confirmPassword = document.getElementsByName("confirm-password")[0].value;
        //     var UpdatePw = $('#UpdatePw');

        //     // ë¹„ë°€ë²ˆí˜¸ê°€ 8~16ìë¦¬ì´ê³  ì˜ë¬¸ ëŒ€ì†Œë¬¸ì, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ ëª¨ë‘ í¬í•¨í•˜ëŠ”ì§€ ê²€ì‚¬ â­•
        //     if (!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[~!@#$%^&*()_+`\-={}[\]:;"'<>,.?\\/]).{8,16}$/.test(password)) {
        //         document.getElementsByName("userPw")[0].setCustomValidity(
        //             "ë¹„ë°€ë²ˆí˜¸ëŠ” 8~16ìë¦¬ì˜ ì˜ë¬¸ ëŒ€ì†Œë¬¸ì, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ ëª¨ë‘ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.");
        //     } else {
        //         document.getElementsByName("userPw")[0].setCustomValidity("");
        //     }

        //     // ë¹„ë°€ë²ˆí˜¸ì™€ í™•ì¸ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ëŠ”ì§€ ê²€ì‚¬ âŒ
        //     if (password != confirmPassword) {
        //         document.getElementsByName("pw_confirm")[0].setCustomValidity("ë¹„ë°€ë²ˆí˜¸ì™€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        //         return
        //     } else {
        //         document.getElementsByName("pw_confirm")[0].setCustomValidity("");
                
        //     }
        // }

    </script>

</body>

</html>