<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/layout/user_layout}"
      >
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>이력서 작성</title>
    
    <style>
      .header-logo img {
        height: 50px;
      }
      .resume-form {
        margin-top: 20px;
      }
      .form-header {
        text-align: center;
        background-color: #007bff;
        color: white;
        padding: 10px;
        border-radius: 8px;
      }
      .profile-pic {
        width: 230px;
        height: 250px;
        background-color: #eee;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        margin-bottom: 20px;
      }

      #preview {
            width: 230px;
            height: 250px;
            border: 1px solid #ccc;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        #preview img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* 이미지가 preview 영역에 맞춰서 잘림 */
        }

        /*input file(파일2)*/
        input[type='file'] {
          display: block;
          width: 0;
          height: 0;
          overflow: hidden;
        }
        .form__input--file_wrap {
          display: flex;
        }
        .form__label--file {
          width: 80px;
          height: 30px;
          line-height:30px;
          background: #999;
          border-radius: 3px;
          color: #fff;
          font-weight: bold;
          display: flex;
          align-items: center;
          justify-content: center;
          cursor: pointer;
        }
        .form__span--file {
          padding: 0 5px 0 10px;
          margin-left: 5px;
          display: block;
          width: 500px;
          min-height: 30px;
          border: 1px solid #e7e7e7;
          border-radius: 3px;
          line-height: 30px;
          color: #999;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
          box-sizing: border-box;
        }

      .footer {
        background-color: #003366;
        color: white;
        padding: 20px 0;
        text-align: center;
        margin-top: 40px;
      }
      .footer a {
        color: white;
        margin: 0 10px;
      }
    </style>
  </head>
  <body layout:fragment="content">
  
    <div class="container resume-form">
      <div class="form-header">
        <h4>이력서 작성</h4>
      </div>
      <form action="/user/SVcreate" method="post">
        <div class="form-group row" style="margin-top: 5px;">
            <label for="title" class="col-sm-2 col-form-label" style="width: 80px;">제목 :</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" id="title">
            </div>
          </div>
          <div class="profile-pic" style="float: left; height: 250px; width: 250px;">
            <div id="preview">
              <img src="" class="img-thumbnail"  alt="이미지를 넣어주세요">
            </div>
            <label for="file">
              <div class="btn-long" style="text-align: center;">사진 추가</div>
            </label>
            <input type="file" name="file" id="file" accept="img/*" style="display: none;">
          </div>
          <div class="form-group row">
            <div class="col-sm-9">
              <div class="form-group">
                <label>이름 : </label> <input type="text" class="form-control" id="name">
              </div>
              <div class="form-group">
                <label>성별 </label>  
                <input type='radio' name='gender' value='female' />여성
                <input type='radio' name='gender' value='male' />남성
                <br>
                <label>나이 </label>  
                <input type="text" class="form-control" id="age">
              </div>
              <div class="form-group">
                <label>이메일 : </label>  <input type="text" class="form-control" id="email">
              </div>
            </div>
          </div>
          <div class="form-group row">
            <div class="col-sm-6 border bg-light rounded-3">
              <h5>학력</h5>
              <div class="form-group">
                <label for="school">학교 :</label>
                <input type="text" class="form-control" id="school">
              </div>
              <div class="form-group">
                <label for="major">전공 :</label>
                <input type="text" class="form-control" id="major">
              </div>
              <div class="form-group">
                <label for="education-status">학력 상태 :</label>
                <input type="text" class="form-control" id="education-status">
              </div>
            </div>
            <div class="col-sm-6 border bg-light rounded-3">
                <h5>경력사항</h5>
                <div class="form-group">
                  <label for="period1">기관 :</label>
                  <input type="text" class="form-control" id="period1">
                </div>
                <div class="form-group">
                  <label for="period2">기간 :</label>
                  <input type="text" class="form-control" id="period2">
                </div>
                <div class="form-group">
                  <label for="duty">담당업무 :</label>
                  <input type="text" class="form-control" id="duty">
                </div>
              </div>
            </div>
            <div class="form-group">
                <label for="self-introduction">자기소개서</label>
                <textarea required minlength="50" class="form-control border bg-light rounded-3" id="self-introduction" rows="5" placeholder="최소 50글자 이상 작성해야 합니다."></textarea>
            </div>
            <div class="upload-btn">
              <div class="form__input--file_wrap">
                <input class="form__input--file" id="upload1" type="file" multiple>
                <label class="btn-long" for="upload1">파일 업로드</label>
                <span class="form__span--file">선택된 파일이 없습니다.</span>
              </div>
                <button type="submit" class="btn-long" onclick="moveToList()">이력서 등록</button>
            </div>
          </div>
      </form>
    </div>
  
  
    <script>
      //이미지 파일 미리보기 업로드
      document.getElementById('file').addEventListener('change', function(event) {
          const file = event.target.files[0];
          const preview = document.getElementById('preview');
          preview.innerHTML = ''; 

          if (file) {
              const reader = new FileReader();
              reader.onload = function(e) {
                  const img = document.createElement('img');
                  img.src = e.target.result;
                  preview.appendChild(img);
              }
              reader.readAsDataURL(file);
          } else {
              preview.innerHTML = '<p>이미지가 없습니다.</p>';
          }
      });


      //파일 업로드2, jquary 이용
      // input file 커스텀 - 파일명 붙이기
    const fileTarget = $('.form__input--file_wrap input');

    fileTarget.on('change', function () { 
      var files = $(this)[0].files;
      var fileArr = [];
      for (var i = 0; i < files.length; i++) {
        fileArr.push(files[i].name);
    }
      
    // 파일명 노출방법1: 배열 값 사이에 공백 추가
    var fileList = fileArr.join(', '); // 배열 값을 쉼표와 공백으로 연결
    $(this).siblings('.form__span--file').text(fileList);

    });
      </script>
  </body>
  </html>